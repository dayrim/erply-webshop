{"remainingRequest":"C:\\Users\\Dmitrijs\\erply-webshop\\node_modules\\@angular-devkit\\build-optimizer\\src\\build-optimizer\\webpack-loader.js??ref--8-1!C:\\Users\\Dmitrijs\\erply-webshop\\node_modules\\ngx-webstorage\\dist\\helpers\\webStorage.js","dependencies":[{"path":"C:\\Users\\Dmitrijs\\erply-webshop\\node_modules\\ngx-webstorage\\dist\\helpers\\webStorage.js","mtime":1512224934000},{"path":"C:\\Users\\Dmitrijs\\erply-webshop\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1530819274189},{"path":"C:\\Users\\Dmitrijs\\erply-webshop\\node_modules\\@angular-devkit\\build-optimizer\\src\\build-optimizer\\webpack-loader.js","mtime":1528256844000}],"contextDependencies":[],"result":["import { STORAGE } from '../enums/storage';\r\nimport { StorageObserverHelper } from './storageObserver';\r\nimport { KeyStorageHelper } from './keyStorage';\r\nimport { MockStorageHelper } from './mockStorage';\r\nimport { STORAGE_NAMES } from '../constants/lib';\r\nvar CACHED = (_a = {}, _a[STORAGE.local] = {}, _a[STORAGE.session] = {}, _a);\r\nvar STORAGE_AVAILABILITY = (_b = {}, _b[STORAGE.local] = null, _b[STORAGE.session] = null, _b);\r\nvar WebStorageHelper = /*@__PURE__*/ (function () {\r\n    function WebStorageHelper() {\r\n    }\r\n    WebStorageHelper.store = function (sType, sKey, value) {\r\n        this.getStorage(sType).setItem(sKey, JSON.stringify(value));\r\n        CACHED[sType][sKey] = value;\r\n        StorageObserverHelper.emit(sType, sKey, value);\r\n    };\r\n    WebStorageHelper.retrieve = function (sType, sKey) {\r\n        if (sKey in CACHED[sType])\r\n            return CACHED[sType][sKey];\r\n        var value = WebStorageHelper.retrieveFromStorage(sType, sKey);\r\n        if (value !== null)\r\n            CACHED[sType][sKey] = value;\r\n        return value;\r\n    };\r\n    WebStorageHelper.retrieveFromStorage = function (sType, sKey) {\r\n        var data = null;\r\n        try {\r\n            data = JSON.parse(this.getStorage(sType).getItem(sKey));\r\n        }\r\n        catch (err) {\r\n            console.warn(\"invalid value for \" + sKey);\r\n        }\r\n        return data;\r\n    };\r\n    WebStorageHelper.refresh = function (sType, sKey) {\r\n        if (!KeyStorageHelper.isManagedKey(sKey))\r\n            return;\r\n        var value = WebStorageHelper.retrieveFromStorage(sType, sKey);\r\n        if (value === null) {\r\n            delete CACHED[sType][sKey];\r\n            StorageObserverHelper.emit(sType, sKey, null);\r\n        }\r\n        else if (value !== CACHED[sType][sKey]) {\r\n            CACHED[sType][sKey] = value;\r\n            StorageObserverHelper.emit(sType, sKey, value);\r\n        }\r\n    };\r\n    WebStorageHelper.refreshAll = function (sType) {\r\n        Object.keys(CACHED[sType]).forEach(function (sKey) { return WebStorageHelper.refresh(sType, sKey); });\r\n    };\r\n    WebStorageHelper.clearAll = function (sType) {\r\n        var storage = this.getStorage(sType);\r\n        KeyStorageHelper.retrieveKeysFromStorage(storage)\r\n            .forEach(function (sKey) {\r\n            storage.removeItem(sKey);\r\n            delete CACHED[sType][sKey];\r\n            StorageObserverHelper.emit(sType, sKey, null);\r\n        });\r\n    };\r\n    WebStorageHelper.clear = function (sType, sKey) {\r\n        this.getStorage(sType).removeItem(sKey);\r\n        delete CACHED[sType][sKey];\r\n        StorageObserverHelper.emit(sType, sKey, null);\r\n    };\r\n    WebStorageHelper.getStorage = function (sType) {\r\n        if (this.isStorageAvailable(sType))\r\n            return this.getWStorage(sType);\r\n        else\r\n            return MockStorageHelper.getStorage(sType);\r\n    };\r\n    WebStorageHelper.getWStorage = function (sType) {\r\n        var storage;\r\n        switch (sType) {\r\n            case STORAGE.local:\r\n                storage = localStorage;\r\n                break;\r\n            case STORAGE.session:\r\n                storage = sessionStorage;\r\n                break;\r\n            default:\r\n                throw Error('invalid storage type');\r\n        }\r\n        return storage;\r\n    };\r\n    WebStorageHelper.isStorageAvailable = function (sType) {\r\n        if (typeof STORAGE_AVAILABILITY[sType] === 'boolean')\r\n            return STORAGE_AVAILABILITY[sType];\r\n        var isAvailable = true, storage;\r\n        try {\r\n            storage = this.getWStorage(sType);\r\n            if (typeof storage === 'object') {\r\n                storage.setItem('test-storage', 'foobar');\r\n                storage.removeItem('test-storage');\r\n            }\r\n            else\r\n                isAvailable = false;\r\n        }\r\n        catch (e) {\r\n            isAvailable = false;\r\n        }\r\n        if (!isAvailable)\r\n            console.warn(STORAGE_NAMES[sType] + \" storage unavailable, Ng2Webstorage will use a fallback strategy instead\");\r\n        return STORAGE_AVAILABILITY[sType] = isAvailable;\r\n    };\r\n    return WebStorageHelper;\r\n}());\r\nexport { WebStorageHelper };\r\nvar _a, _b;\r\n//# sourceMappingURL=webStorage.js.map\r\n",null]}